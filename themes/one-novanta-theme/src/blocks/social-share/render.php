<?php
/**
 * PHP file to render the block on server to show on the front end.
 *
 * The following variables are exposed to the file:
 *     $attributes (array): The block attributes.
 *     $content (string): The block default content.
 *     $block (WP_Block): The block instance.
 *
 * @see https://github.com/WordPress/gutenberg/blob/trunk/docs/reference-guides/block-api/block-metadata.md#render
 *
 * @var array<mixed> $attributes The block attributes.
 * @var string       $content The block content.
 * @var WP_Block     $block The block.
 *
 * @package OneNovantaTheme\Blocks
 */

// Get the permalink and title.
$separator = '%20&mdash;%20';
$permalink = get_permalink();

if ( empty( $permalink ) ) {
	return;
}

$permalink  = rawurlencode( $permalink );
$post_title = rawurlencode( get_the_title() );

$services_data = array(
	'linkedin' => array(
		'label' => __( 'Share on LinkedIn', 'one-novanta-theme' ),
		'url'   => 'https://www.linkedin.com/shareArticle?mini=true&url=' . $permalink . '&title=' . $post_title,
		'icon'  => '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 45 45" width="45" height="45" fill="none"><path fill="#fff" d="M43.085 14.103A22.115 22.115 0 0 0 38.33 7.05a22.11 22.11 0 0 0-7.053-4.755A22.056 22.056 0 0 0 22.64.551a22.109 22.109 0 0 0-15.691 6.5 22.113 22.113 0 0 0-4.755 7.052A22.051 22.051 0 0 0 .45 22.74a22.119 22.119 0 0 0 6.5 15.69 22.11 22.11 0 0 0 7.053 4.755 22.057 22.057 0 0 0 8.638 1.745c2.994 0 5.9-.588 8.637-1.745a22.11 22.11 0 0 0 7.053-4.755 22.121 22.121 0 0 0 6.5-15.69c0-2.995-.587-5.901-1.745-8.638Z"/><path fill="gray" d="M34.574 23.296v8.496H29.6v-7.917c0-.997-.184-1.814-.554-2.45-.371-.635-.999-.953-1.883-.953-.708 0-1.267.189-1.678.567a3.68 3.68 0 0 0-.905 1.242c-.08.162-.12.35-.12.569v8.942h-4.924V16.924h4.924v2.124c-.049 0-.073.025-.073.072h.073v-.072c.338-.514.828-1.054 1.472-1.617.643-.564 1.641-.845 2.994-.845 1.64 0 2.992.539 4.054 1.618 1.062 1.078 1.593 2.775 1.593 5.092ZM17.123 12.336c0 .707-.265 1.303-.796 1.786-.53.483-1.207.724-2.028.724-.868 0-1.548-.241-2.039-.724-.492-.483-.737-1.079-.737-1.786 0-.757.261-1.367.785-1.835.523-.466 1.21-.7 2.065-.7.772 0 1.407.234 1.906.7.498.468.78 1.078.845 1.835ZM11.789 16.922h4.971V31.79h-4.971z"/></svg>',
	),
	'facebook' => array(
		'label' => __( 'Share on Facebook', 'one-novanta-theme' ),
		'url'   => 'https://www.facebook.com/sharer/sharer.php?u=' . $permalink . '&title=' . $post_title,
		'icon'  => '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 45 45" width="46" height="45" fill="none"><path fill="#fff" d="M43.602 14.103a22.107 22.107 0 0 0-4.755-7.053 22.107 22.107 0 0 0-7.052-4.755A22.059 22.059 0 0 0 23.157.551a22.107 22.107 0 0 0-15.69 6.5 22.108 22.108 0 0 0-4.756 7.052A22.058 22.058 0 0 0 .967 22.74a22.114 22.114 0 0 0 6.5 15.69 22.107 22.107 0 0 0 7.052 4.755 22.059 22.059 0 0 0 8.638 1.745c2.995 0 5.9-.588 8.638-1.745a22.108 22.108 0 0 0 7.052-4.755 22.113 22.113 0 0 0 6.5-15.69c0-2.995-.587-5.901-1.745-8.638Z"/><path fill="gray" d="m28.935 23.744.58-4.072h-4.423v-2.607c0-1.18.356-1.989 2.214-1.989h2.36v-3.648a33.4 33.4 0 0 0-3.441-.162c-3.398 0-5.727 1.902-5.727 5.392v3.014h-3.855v4.072h3.874v10.47h4.6v-10.47h3.818Z"/></svg>',
	),
	'copy'     => array(
		'label' => __( 'Copy Post link', 'one-novanta-theme' ),
		'url'   => rawurldecode( $permalink ),
		'icon'  => '<svg xmlns="http://www.w3.org/2000/svg" xml:space="preserve" width="45" height="45" viewBox="0 0 1080 1080"><path fill="#fff" d="M1034.832 338.472A530.568 530.568 0 0 0 920.712 169.2 530.592 530.592 0 0 0 544.128 13.224a530.592 530.592 0 0 0-376.56 156 530.592 530.592 0 0 0-114.12 169.248 529.392 529.392 0 0 0-41.88 207.288 530.736 530.736 0 0 0 156 376.56 530.592 530.592 0 0 0 169.248 114.12 529.44 529.44 0 0 0 207.312 41.88c71.88 0 141.624-14.112 207.336-41.88a530.592 530.592 0 0 0 169.248-114.12 530.712 530.712 0 0 0 156-376.56c0-71.88-14.112-141.624-41.88-207.312Z" class="copy-circle" vector-effect="non-scaling-stroke"/><path fill="gray" d="m561.504 660.792-100.848 98.952a66.192 66.192 0 0 1-45.48 18 66.144 66.144 0 0 1-45.504-18 62.952 62.952 0 0 1-13.992-20.472 61.968 61.968 0 0 1 13.992-68.808l100.848-98.952a25.368 25.368 0 0 0 0-36.216 26.352 26.352 0 0 0-36.912 0L332.76 634.512a113.04 113.04 0 0 0-30.672 79.728 113.208 113.208 0 0 0 34.08 78.36 117.552 117.552 0 0 0 79.896 33.456 117.744 117.744 0 0 0 81.24-30.096l101.112-98.952a25.368 25.368 0 0 0 0-36.24 26.352 26.352 0 0 0-36.912 0ZM784.56 352.704a117.864 117.864 0 0 0-82.296-33.288 117.864 117.864 0 0 0-82.272 33.288L518.88 451.656a25.2 25.2 0 0 0 0 36.216 26.544 26.544 0 0 0 36.912 0l100.872-98.952a66.168 66.168 0 0 1 45.48-18.024c16.968 0 33.288 6.456 45.48 18a62.834 62.834 0 0 1 13.992 20.472 61.968 61.968 0 0 1-13.992 68.808l-100.848 98.952c-4.872 4.776-7.656 11.28-7.68 18.12 0 6.816 2.76 13.368 7.68 18.096a26.4 26.4 0 0 0 36.912 0l100.872-99.216a113.424 113.424 0 0 0 33.912-80.712c0-30.24-12.192-59.28-33.912-80.712ZM476.256 655.176a26.101 26.101 0 0 0 18.456 7.392 26.519 26.519 0 0 0 18.456-7.392l127.896-125.472a25.368 25.368 0 0 0 0-36.24 26.352 26.352 0 0 0-36.912 0L476.232 618.96c-4.872 4.752-7.632 11.28-7.68 18.096 0 6.84 2.76 13.368 7.68 18.12Z" class="copy-link" vector-effect="non-scaling-stroke"/><path fill="gray" d="m276.13 496.613 29.02-29.02c14.124-14.132 37.425-14.132 51.557 0l125.62 125.627 240.966-241.334c14.124-14.124 37.426-14.124 51.557 0l29.013 29.02a36.167 36.167 0 0 1 0 51.16L507.918 728.01l-.766.766-.765.765-.766.383-.382.765-.766.383-.765.765-.766.383-.765.383-.765.773-.766.368-.765.397-.766.383-.765.383-.766.382-1.155.383-.766.383-.765.382-.766.383h-.765l-.765.383-1.141.39h-.766l-.765.383h-1.906l-.766.382h-1.53l-1.141.383h-4.976l-1.14-.383h-1.531l-.766-.382h-1.906l-.766-.383h-.765l-1.14-.39-.766-.383h-.766l-.765-.383-.766-.382-.772-.383-.766-.383h-.383c-3.43-1.538-6.866-4.21-10.296-7.257L276.07 547.794a36.263 36.263 0 0 1 .06-51.181z" class="copy-check" vector-effect="non-scaling-stroke"/></svg>',
	),
	'mail'     => array(
		'label' => __( 'Email this Page', 'one-novanta-theme' ),
		'url'   => 'mailto:?subject=' . ( $post_title ? $post_title : $permalink ) . '&body=' . $post_title . $separator . $permalink,
		'icon'  => '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 45 45" width="45" height="45" fill="none"><path fill="#fff" d="M42.635 14.103A22.107 22.107 0 0 0 37.88 7.05a22.107 22.107 0 0 0-7.052-4.755A22.059 22.059 0 0 0 22.19.551 22.107 22.107 0 0 0 6.5 7.05a22.108 22.108 0 0 0-4.755 7.052A22.058 22.058 0 0 0 0 22.74a22.114 22.114 0 0 0 6.5 15.69 22.107 22.107 0 0 0 7.052 4.755 22.059 22.059 0 0 0 8.638 1.745c2.995 0 5.9-.588 8.638-1.745a22.108 22.108 0 0 0 7.052-4.755 22.113 22.113 0 0 0 6.5-15.69c0-2.995-.587-5.901-1.745-8.638Z"/><path fill="gray" d="M22.78 35.587c.853.102 1.668-.292 2.134-.825.233-.266.388-.444.44-.863l6.392-17.746c.427-1.029.09-2.082-.725-2.768-.815-.685-1.927-.85-2.898-.28l-16.898 8.912c-1.06.495-1.565 1.612-1.307 2.755.169 1.066 1.165 1.904 2.355 1.98l6.56.584 1.591 6.271c.259 1.143 1.255 1.98 2.355 1.98Zm-.027-2.488-1.617-6.6 4.813-5.51c.466-.533.414-1.193-.129-1.65-.543-.457-1.216-.406-1.682.127l-4.813 5.509-6.896-.559s-.169.013-.182-.152c-.09-.076-.012-.165-.012-.165l.077-.089 16.82-8.822s.078-.089.26.063c.18.153.103.242.103.242L23.18 33.15s.013.165-.246.102c-.168.012-.18-.153-.18-.153Z"/></svg>',
	),
);

$wrapper_attributes = get_block_wrapper_attributes(
	[
		'class' => 'novanta-social-share',
	]
);
?>

<ul <?php one_novanta_kses_post_e( $wrapper_attributes ); ?>>
	<?php foreach ( $services_data as $service => $data ) : ?>
		<li class="novanta-social-share__item">
			<a
				href="<?php echo esc_url( $data['url'] ); ?>"
				target="_blank"
				rel="noopener noreferrer"
				class="novanta-social-share__link novanta-social-share__link--<?php echo esc_attr( $service ); ?>"
				title="<?php echo esc_attr( $data['label'] ); ?>"
			>
				<?php one_novanta_kses_post_e( $data['icon'] ); ?>
				<span class="screen-reader-text"><?php echo esc_html( $data['label'] ); ?></span>
			</a>
		</li>
	<?php endforeach; ?>
</ul>
